\documentclass[11pt,a4j]{jsarticle}
\title{デジタル回路}
\author{1413176 三村幸祐}
\date{2016/07/21 \, /28}
\usepackage{booktabs}

\pagestyle{empty}

\begin{document}
  
%  \tableofcontents
  
  \newpage
  
 \section{はじめに}
  近年は超小型化された電子素子(主にトランジスターなどの半導体)を用いた電気信号を、0か1かのデジタル信号として
  扱う技術は身の回りや社会で幅広く見かける。したがってこの手の技術者にはデジタル信号、回路を扱えることが必須となってきている。
  
  電子素子を用いた回路には集積回路(IC)や大規模集積回路(LSI)などがあり、これらを組み合わせることで大きな電気的システムを構成することができる。
  
  一方、FPGAといわれるプログラミングにより自由な回路の書き換えを可能にするボードが存在する。今回はそれをもちいてパソコン上で発生、取得したデジタルデータを
  扱っていくものとする。
  
  今回の実験内容は大きく分けて7つに分類することができて
  \begin{enumerate}
   \item AND,OR,XORゲートの論理演算の入出力動作確認
   \item NOTゲートの遅延測定
   \item 全加算器の動作確認(真理値表の作成)
   \item \verb|RS_FF|の動作確認(真理値表の作成)
   \item \verb|JKT_FF,JKTMS_FF|のタイミングチャートの作成
   \item \verb|T_FF,TMS_FF|のタイミングチャートの作成
   \item \verb|D_FF,DMS_FF|のタイミングチャートの作成
  \end{enumerate}
  の構成で、進めていく。
  
  つまり今回扱かう内容は次のようにまとめることができる。
  \begin{itemize}
   \item 組み合わせ論理回路(AND,ORなどの各論理ゲート)
   \item 順次論理回路(フリップフロップによる記憶回路)
  \end{itemize}


  \newpage
  
 \section{実験の目的と原理}
  デジタル信号というのは必ず1か0、どちらかの値で表される。これと論理演算の真、偽関係を対応させて回路を組立てていくのがデジタル回路である。
  つまりこの論理回路に対応するAND,OR,XOR,NOTなどのゲートの特性を調べていくことは、アナログ受信からデジタル信号として扱われるまでの過程の理解につながる。
  \subsection{組み合わせ論理回路}
  論理回路において、出力が一時点の入力に完全関数的であるとき、それを組み合わせ論理回路と呼ぶ。また組み合わせ論理回路は複数個の論理ゲートと呼ばれる単位演算子に分けられる。
  この実験で用いる重要ないくつかの論理ゲートとその真理値表を図\ \ に示す。
  
  \newpage
  
  各論理ゲートについて触れておきたい。
  \begin{enumerate}
   \item ANDゲート: \\
   2つの入力値が等しいときに1、異なるときに0を出力する論理ゲート \\
   \item ORゲート: \\
   2つの入力のうち、少なくともどちらか1つが真(1)であれば1、どちらも偽(0)であれば0を出力する論理ゲート \\
   \item XORゲート: \\
   2つの入力が等しいとき0、異なるとき1を出力する論理ゲート \\
   \item NOTゲート: \\
   入力は1つで、出力値として入力の逆を返す論理ゲート \\
  \end{enumerate}
  
  
  また複数桁の数値計算をするうえでも重要な半加算器・全加算器も論理ゲートの組み合わせで構成することができる。
  これについては実験内容の章で図とともに述べるが、全加算器は2つの入力データ、そして1つ前の桁上げ出力による入力に対して、
  それらの和の数をもとめ桁上げ、同桁として出力することができる論理回路である。
  
  \subsection{順次論理回路}
  上の組み合わせ論理回路に対して、順次論理回路とは、その出力が一時点での入力だけでなく今までの入力も関係してくる論理回路のことを指す。
  
  最も主要な順次論理回路にフリップフロップ回路がある。これは前回の出力結果を保持、もしくは消去、あるいは前回の値には関わらず発散する、など様々な
  記録の操作を可能にする回路である。次にこの実験でも用いる重要なフリップフロップ回路を図\ \ \ \ による回路図、真理値表ともに説明する。
  
  \newpage
  
  \subsubsection{RSフリップフロップ}
  まずRSフリップフロップについて説明する。回路図は図\ \ に示す通りだが、入力が(S,R)=(0,0)の場合には出力Qは変化なし、
  入力が(0,1)のときには出力Qは0、入力(1,0),(1,1)のとき出力Qは1となるような回路である。
  
  
  またここでは\verb|RST_FF|の記述されるようなクロック入力つきのフリップフロップ回路の説明もする。例として\verb|RST_FF|を図\ \ に示す。
  ck(クロック入力)が0の場合、(S,ck),(R,ck)を入力とするような最初のNANDゲートで出力は必ず1となり、RSにおける(0,0)入力の場合と、つまり出力Qが変化しない場合と
  等価になる。一方ckが1の場合、最初のNANDゲートの出力はS,RそれぞれのNOT出力と、つまりckによらずRSの回路と等価になる。
  
  まとめると、クロック入力つきの場合は、
  \begin{itemize}
   \item ck=0のときは、入力値によらずQは変化なし。
   \item ck=1のときは、クロック無し回路の動作にしたがう。
  \end{itemize}
  ということになる。つまり、ckによってフリップフロップ回路の動作のon,offを制御することができる。
  
  \newpage
  
  
  \subsubsection{JKフリップフロップ}
  つぎにJKフリップフロップ回路(図\ \ )について説明する。この回路はおおよその動作が入力が(J,K)=(0,0)の場合には出力Qは変化なし、
  入力が(0,1)のときには出力Qは0、入力(1,0)のとき出力Qは1、としてRSフリップフロップとにている。
  ただし、入力が(1,1)の場合は出力Qは以前の値と反転する。これがJKフリップフロップ回路の特徴で、真理値表が明瞭になる。
  
  ここで、\verb|JKMS_FF|と表記されるようなマスタースレーブ(MS)についての説明もしておく(図\ \ 参照)。
  ck入力による図\ \ 向かって左側のRS(マスター側)、向かって右側のRS(スレーブ側)の動作について考えよう。
  ck=1のとき、マスター側は通常の出力をするがスレーブ側がck=0の入力を受けとることで、結局出力Qの値は変わらない。
  一方ck=0のとき、マスター側が機能しないが、スレーブ側はck=1を受け取って通常の機能をする。したがって
  \begin{itemize}
   \item ck=0のときJKフリップフロップとして機能。
   \item ck=1のときJKフリップフロップの機能が停止(入力によらないQの保持)。
  \end{itemize}
  となり、通常のck挙動と反転する。
  
  ただし、MS使用の目的はそこではなく、RSが二つあることで、必ずどちらかはck入力によってoffにされている。したがって実際の使用に際してもその境界が
  はっきりすることで動作が安定する。
  
  \newpage
  
  
  \subsubsection{Tフリップフロップ}
  ここからはckをのぞき入力が１つの特殊なフリップフロップ回路である。
  図\ \ に示すものがTフリップフロップ回路である。図\ \ を見た通り、JKの入力がTで統一されているため、Qの出力値は
  \begin{itemize}
   \item T=0で、Qの変化無し。
   \item T=1で、Qは反転。
  \end{itemize}
  となる。

  
  \subsubsection{Dフリップフロップ}
  最後にDフリップフロップ(図\ \ )について。
  DはJKの入力を同じ値で統一したのと反対に、D=0なら(J,K)=(0,1)、D=1なら(J,K)=(1,0)というように反転した入力JK回路に相当する。
  
  つまり
  \begin{itemize}
   \item D=0で、Qは必ず0。
   \item D=1で、Qは必ず1。
  \end{itemize}
  となるような今までの入力に関係なく動作する順次論理回路である。
  
 \newpage
  
  
 \section{実験内容}
  今回の実験で使用したハード、ソフトウェア環境を記載する。
   \begin{table}[htb]
  \begin{center}
    \caption{実験環境(使用したハードウェア、ソフトウェア)}
     \begin{tabular}{|c|c|} \hline
コンピュータ & DOS/V PC \\ \hline
OS & Windows 8.1 \\ \hline
CAD(回路図用) & Quartus2 12.1(Altera社) \\ \hline
FPGAボード & DE2-70ボード(EP2C70F896C6N搭載) \\ \hline
    \end{tabular}
    \label{tab:price}
  \end{center}
   \end{table}
   
   
  これより実験は以下のような順次手順で進めた。
  
  \subsection{AND,OR,XORゲートの論理演算の入出力動作確認}
  実験回路は図\ \ に示す。入力A,Bをon,offで切り替えて、X,Y,Z等の出力挙動を観察。

  
  \subsection{NOTゲートの遅延測定}
  図\ \ に回路図を示す。
  \begin{enumerate}
   \item NOTゲート8個に対して、その入力からの出力の遅延を観察。
   \item こんどはNOTゲートを7個にして、同様に出力の入力からの遅延を観察。
  \end{enumerate}
  
  \newpage

  
  \subsection{全加算器の動作確認(真理値表の作成)}
  半加算器、全加算器の論理回路をそれぞれ図\ \ ,\ \ に示す。ここでは全加算器を半加算器を用いて組み、
  全加算器の真理値表を完成させた。

  
  \subsection{RSの動作確認(真理値表の作成)}
  図\ \ ,\ \ にそれぞれ示したRS,RST回路を用いる。
  \begin{enumerate}
   \item RSに対して、動作表を完成。
   \item RS,RST回路に次のテストベクトル(R,Sの組)を入れ、タイミングチャートを作成。\\
   000/010/110/010/000/000/001/101/001/000/000/011/111/011/111/011/010/110/010/000/00/000/001/101/001/000/100/000
  \end{enumerate}

  
  \subsection{JKT,JKTMSのタイミングチャートの作成}
  図\ \ のJKT,JKTMS回路にRSの実験と同様のテストベクトル(J,Kの組)を入れて、タイミングチャートを作成。
  
  \newpage
  
  \subsection{T,TMSのタイミングチャートの作成}
  T、TMS回路を図\ \ に示した。次のテストベクトルを入力して、タイミングチャートを作成。
  
  00/10/00/10/00/01/11/01/11/01/11/01/11/01/11/01
  
  \subsection{D,DMSのタイミングチャートの作成}
  図\ \ に示すようなD,DMSの論理回路にTと同様のテストベクトルを入力してタイミングチャートを作成。
  
  
  \newpage
  
  
 \section{実験結果}
 まず1の「AND,OR,XORゲートの論理演算の入出力動作確認」の表を表\ \ に示す。これは準備課題で予測してきたものとまったく一致していた。
 
 
  \begin{table}[htb]
  \begin{center}
    \caption{AND,OR,XORの入出力動作の観察結果}
    \begin{tabular}{ccccccccccccccc} \toprule
SW0 & SW1 & P31 & P33 & A & B & X & P35 & LEDR2 & Y & P37 & LEDR3 & Z & P39 & LEDR4 \\ \midrule
on & on & H & H & 1 & 1 & 1 & H & 点 & 1 & H & 点 & 0 & L & 滅 \\
on & off & H & L & 1 & 0 & 0 & L & 滅 & 1 & H & 点 & 1 & H & 点 \\
off & on & L & H & 0 & 1 & 0 & L & 滅 & 1 & H & 点 & 1 & H & 点 \\
off & off & L & L & 0 & 1 & 0 & L & 滅 & 0 & L & 滅 & 0 & L & 滅 \\ \bottomrule
    \end{tabular}
    \label{tab:price}
  \end{center}
  \end{table}
  
  また同実験のAND,OR,XORのデジタル出力波形を次ページの図\ \ に、AND,ORゲートのアナログ出力波形を図\ \ に、XORゲートのアナログ出力波形を図\ \ に示した。
  デジタル波形とアナログ波形の概形は等しいが、デジタル波形に対してアナログ波形には立ち上がり、立ち下がりの際の有限の勾配が確認できる。
  
  \clearpage
  
  
  この「立ち上がり、立ち下がりの際の遅延」を「NOT回路の複数組み合わせによって測定した実験」のデータを前ページの図\ \ ,\ \ に載せた。それぞれNOTゲート8本、NOTゲート7本を直列につないだ
  出力として得られた立ち上がり、立ち下がりのアナログ波形である。
  
  ここから得られた結果を次の表\ \ にまとめる。
  
   \begin{table}[htb]
  \begin{center}
    \caption{7本、及び8本直列NOTゲートによる出力遅延測定}
    \begin{tabular}{ccccc} \toprule
 & NOT8本 & NOT7本 \\ \midrule
立ち上がり遅延時間/ns & 67 & 70 \\
立ち下がり遅延時間/ns & 68.5 & 77 \\ \bottomrule
    \end{tabular}
    \label{tab:price}
  \end{center}
\end{table}
  
  
  
  次にフリップフロップ回路についての実験データをRSより順に載せる。RSのタイミングチャートは図\ \ に示す。
  RSフリップフロップは少ない数の論理ゲートを組み合わせたものであるため、動作は安定している。タイミングチャートの形も準備課題どおりとなっている。
  
  \clearpage
  
  最後に次ページの図\ \ ,\ \ にそれぞれ示すのがTフリップフロップ、Dフリップフロップの測定タイミングチャートである。
  これは先ほどのRSとは違い、TのQnや、DのQ,Qnが不安定な出力をしていることが確認できる。
  
  

  \newpage
  
  
  
 \section{考察}
   
 
  \subsection{AND,OR,XORゲートの論理演算の入出力動作確認}
  実験結果の表\ \ にあるように、動作表の実験値は準備した予測値と一致した。　
  この予測をするときにはXはA,BのAND出力、YはA,BのOR出力、ZはA,BのXOR出力であることから実験値を求めた。したがってそれが正しく、安定して0か1かの値で返されていることが確認できた。
  
  デジタル回路は実験結果の表\ \ からもわかるように非常に安定して、正確な値を出力している。
  図\ \ \ \ を見てみると、大きなスケールに対して一瞬で高電圧、低電圧を変換しているように見える。ただしのちのNOTゲートの遅延測定でもわかる通り、立ち上がり、立ち下がりはnsスケールで
  行われるため、閾値電圧を1.8Vと定めた場合、その出力が安定することはわかる。
  
  \subsection{NOTゲートの遅延測定}
  ゲートの遅延は論理ゲート系と導線との間の金属接触の際の微小な電気容量に起因している。[1]
  しかし今回の実験結果を見てみると、NOTゲートが7本の時の方が8本よりも遅延時間が長い。これは上の説明には矛盾している。つまりこれ以外の理由が
  私たちの実験結果にはあったはずである。個数を除いた7本と8本のNOT直列回路の違いは、出力が反転されるか反転されないか、にある。
  
  したがって今回の直列本数に関して2種類試した実験結果では、最終的に反転している出力の方がしていない出力よりも遅延時間が長くなりうる、という原因要素が上の金属接触の電気容量に加えて
  存在するものと判断した。
  
  \newpage
  
%   \subsection{全加算器の動作確認(真理値表の作成)}
  
  
%   \subsection{RSの動作確認(真理値表の作成)}
  
  
%   \subsection{JKT,JKTMSのタイミングチャートの作成}
  
  
  \subsection{T,TMSのタイミングチャートの作成}
  T,TMSで観測したデジタル波形は準備課題で予測したものとは、特にTに関しては大きく異なっていた。
  準備課題に関しては原理で述べた真理値表(図\ \ )を元にckが1の時を対応させて作成した予測であった。
  
  原理でも述べたが、Tフリップフロップ回路というのはJKTに入力値Tを入れていくことと等しく、JKT回路のJとKが常に同値を持つ、つまり図7より図9の真理値表が作れることは理解できる。
  したがってTが0のときはJKTの入力が(0,0)の時と同様の出力、つまり論理値の保持につながる。
  
  また同様に、TMSフリップフロップ回路はJKTMSに入力Tを加えることと等価である。したがって、Tフリップフロップに対して、ckによる挙動が逆になったものと等しく、動作が安定するという特徴を持つはずである。
  
  以上から、Tフリップフロップ回路とTMSフリップフロップ回路ではck動作が逆という結果だけが予測の時点では残ったが、JKTの内部で2つのRSフリップフロップ回路を用いることにより、出力結果が安定する、
  という原理が観測結果からは見えてくる。
  
  ck(トリガ)の効果には、アナログ的な立ち上がり、立ち下がりの際の遅延による時間分解能というものがある。このクロック入力による出力の遅延があるために、高周波数で切り替えられるクロックが、
  時間分解能による周波数の限界、分解能周波数を越えてしまい、Tフリップフロップ回路ではクロックがうまく機能しなくなってしまう。[2]
  
  その点TMSのようにマスターと、スレーブと2つのRST回路を使用すると、必ず片方はクロック入力により機能が停止しているはずであるから、安定的に論理値を保持していることができる。
  
  \subsection{D,DMSのタイミングチャートの作成}
  ここでもDのデジタル波形は準備課題のタイミングチャートとは異なる挙動を示した。
  
  上のTとは反対に、DはJKTの入力JとKが常に異なる値を持つ回路である。
  つまり図10のように考えることができ、この真理値表を元に準備課題のタイミングチャートは作成した。
  
  これより、Dは以前の論理値に関係なく出力するかいろである。DMSとDとの違いは、その安定性、ckの逆動作の点でTMSとTとの違いと等しい(前項参照)。
  
  \newpage
  
  
 \section{おわりに}
  今回は、自然物理的にはアナログである入力から、コンピュータ科学などの分野で使われるデジタルという概念への転換を見ていくことが私の主な目的であった。
  
  しかし、論理ゲートによる遅延など、考察するのに幾分多くの実験データがないといけない、と言う点で止まってしまったのは理解が足りていない状況で実験に挑んでいたことを感じた。
  
  
  一方、フリップフロップなどの順次論理回路からは、出力の安定化という実際の現場での必要性を考えることができ、その点、デジタル信号の操作に関して興味のわくきっかけとなった。
  
  
 \section{参考文献}
  [1]www.ai-l.jp > LB5.Logic-delay-power.pdf
  [2]雨宮好文、「現代電子回路学2」、p84~86
  
\end{document}